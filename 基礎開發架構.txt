基礎開發架構（通用範本）

1) 專案定位與角色
- 專案名稱：[ProjectName]
- 主要角色：管理者、單位主管、一般成員、外部協作
- 主要目標：建立可追溯、可控權限的工程/專案執行流程

2) 核心資料架構（Data Architecture）
- 租戶模型：org_id（組織）、unit_id（單位）
- 基礎表：orgs / units / profiles / memberships
- 核心表：
  - projects：專案主檔（名稱、狀態、期間、負責人、單位）
  - project_tasks：任務明細（所屬專案、狀態、工期、負責人、排序）
  - progress_logs：進度回報（照片、描述、數量、回報人、時間）
  - drive_items：檔案索引（檔案來源、連結、所屬專案/任務）
  - cost_requests / cost_items / cost_attachments：成本請款流程
  - assist_requests：跨單位協作/支援請求
  - task_change_logs：任務異動與審計
- 共通欄位：org_id、unit_id、created_at、updated_at、created_by
- 命名規範：snake_case；外鍵欄位以 *_id 結尾

3) Project / Task 具體說明（呈現與控制）
- Project
  - 資料欄位：名稱、狀態、期間、負責人、單位、預算、標籤
  - 呈現方式：專案列表 + 篩選（狀態/單位/負責人）
  - 編輯方式：右側 Drawer 或 Sheet（避免頁面向下跳）
  - 控制方式：
    - 狀態流轉：draft -> active -> closed
    - 權限：同 org 可讀；同 unit 可寫
- Task
  - 資料欄位：名稱、描述、狀態、起訖日、工期、負責人、排序
  - 呈現方式：清單 + 甘特/表格切換
  - 編輯方式：任務點擊開啟側邊編輯器
  - 控制方式：
    - 狀態流轉：todo -> doing -> done
    - 權限：同 org 可讀；同 unit 可寫

4) 權限控制（Permission Control）
- RLS 核心規則：
  - SELECT：同 org 可讀
  - WRITE：同 org + 同 unit 可寫
- 角色矩陣：admin / manager / member
- 管理台：使用 service role（或 server action）執行高權限操作

5) 儀表板（Dashboard）
- KPI 指標：
  - 專案數（進行中/已結案）
  - 任務完成率、逾期率
  - 本週進度回報數量
  - 成本請款金額與狀態分布
- 圖表：狀態分布、時間序列、部門/單位比較

6) API 與寫入策略
- 使用 Supabase Auth + RLS 做一般寫入
- 重要寫入與後台操作走 server action（service role）
- 建議提供 RPC：批量寫入、統一驗證與計算（例如請款總額）

7) 測試與驗收
- RLS smoke test：正測/負測可重跑
- UI 驗收：任務編輯、上傳、請款流程

8) 部署與維運
- Web：Vercel 或 Cloud Run
- Mobile：Expo EAS
- 監控：錯誤追蹤、操作紀錄、審計報表
